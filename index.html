<!DOCTYPE html>

<html lang="en">
<head>
<title>Stingracer</title>
<link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>
<body style="margin: 0; padding: 0; background: #000000; overflow: hidden;">
    
<!-- loading-screen-->
<div class="loading-container" id="loading-screen" style = "position: absolute; top: 50%; left: 50%;" >
<div><h3 class="loading-text" style="font-family: monospace; font-size: 20px; color: white;">LOADING</h3></div>
</div>
    
<!-- Viewport--> 
<div class="wrapper" id="mainarea">
<div id='loadTasks'> </div>
<canvas tabindex=0 id="canvas" oncontextmenu= "return false;" class="emscripten" style="display: none; overflow: hidden; min-height: 100vh; min-width: 100vw; "></canvas>
<div id="fullscreen_request"></div>
</div>
	

<script type="module">
async function loadWasm() {
    const gzUrl = "Stingracer-HTML5-Shipping.wasm.gz";

    try {
    const response = await fetch(gzUrl);
    if (!response.ok) throw new Error("Не удалось загрузить .gz");

    const compressed = await response.arrayBuffer();

    // Распаковываем gzip вручную
    const ds = new DecompressionStream("gzip");
    const decompressedStream = new Response(compressed).body.pipeThrough(ds);
    const decompressed = await new Response(decompressedStream).arrayBuffer();

    // Запускаем WASM
    const module = await WebAssembly.instantiateStreaming(
        new Response(decompressed),
        importObject // ← замени на свой importObject, если есть
    );

    document.getElementById("status").textContent = "Готово! Игра запущена.";
    // Дальше твой код запуска игры
    // module.instance.exports.startGame(); или что у тебя там

    } catch (e) {
    console.error("Ошибка загрузки WASM", e);
    document.getElementById("status").innerHTML = 
        "Ошибка загрузки.<br>Попробуйте обновить страницу или используйте другой браузер.";
    }
}

loadWasm();
</script>


<script src="Stingracer-HTML5-Shipping.UE4.js"></script>
</body>
</html>
